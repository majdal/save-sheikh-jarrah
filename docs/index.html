<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8' />
  <title></title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.css' rel='stylesheet' />
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }

    a.button {
      display: inline-block;
      padding: 0.7em 1.4em;
      margin: 0 0.3em 0.3em 0;
      border-radius: 0.15em;
      box-sizing: border-box;
      text-decoration: none;
      font-family: sans-serif;
      text-transform: uppercase;
      font-weight: 400;
      color: #FFFFFF;
      background-color: #3369ff;
      box-shadow: inset 0 -0.6em 0 -0.35em rgba(0, 0, 0, 0.17);
      text-align: center;
      position: relative;
    }

    a.button:active {
      top: 0.1em;
    }

    @media all and (max-width:30em) {
      a.button {
        display: block;
        margin: 0.4em auto;
      }
    }
  </style>
</head>

<body>

  <div id='map'></div>

  <script>

    function orNull(prop) {
      return prop ? prop : '';
    }

    mapboxgl.accessToken = 'pk.eyJ1Ijoia2FtaWN1dCIsImEiOiJMVzF2NThZIn0.WO0ArcIIzYVioen3HpfugQ';

    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/light-v10',
      center: [35.231944, 31.794444],
      zoom: 8
    });

    map.on('load', function () {
      map.addSource('locations', {
        type: 'geojson',
        data: 'points.geojson'
      });

      map.addLayer({
        "id": "locations",
        "type": "circle",
        source: 'locations',
        paint: {
          'circle-color': '#4264fb',
          'circle-radius': 8,
          'circle-stroke-width': 2,
          'circle-stroke-color': '#ffffff'
        }
      });

      map.on('click', function (e) {
        var features = map.queryRenderedFeatures(e.point, {
          layers: ['locations']
        });

        if (!features.length) {
          return;
        }

        var feature = features[0];

        var popup = new mapboxgl.Popup({ offset: [0, -15] })
          .setLngLat(feature.geometry.coordinates)
          .setHTML('<h3>' + '<a href=' + orNull(feature.properties.label) + ' target=_blank>Source</a>' + 
            '</h3><p>' + orNull(feature.properties.link) + '</p>' +
            '<p>' + orNull(feature.properties.notes) + '</p>'
          )
          .addTo(map);
      });
    })

  </script>

</body>

</html>